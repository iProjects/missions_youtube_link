@model missions_youtube_links.Entities.user_dto

@{
    ViewBag.Title = "Login";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Login</h2>

@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "frm_login" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

    <fieldset>

        <div class="login">

            <div class="form-group">
                @Html.LabelFor(model => model.email, htmlAttributes: new { @class = "form-label" })
                @Html.EditorFor(model => model.email, new { htmlAttributes = new { @required = "required", @class = "form-control", @placeholder = "Email", @id = "txtemail", @autofocus = "autofocus", @autocomplete = "autocomplete", @type = "email" } })
                @Html.ValidationMessageFor(model => model.email, "", new { @class = "lbl_error text-danger" })
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.password, htmlAttributes: new { @class = "form-label" })
                @Html.EditorFor(model => model.password, new { htmlAttributes = new { @required = "required", @class = "form-control", @placeholder = "Password", @id = "txtpassword", @type = "password" } })
                <span id="lblshowpassword">Show Password</span>
                <input type="checkbox" id="chkshowpassword" class="checkbox" name="chkshowpassword" />
                @Html.ValidationMessageFor(model => model.password, "", new { @class = "lbl_error text-danger" })
            </div>

            <div class="form-group">
                <input type="submit" value="Login" id="btnlogin" class="btn btn-success btn_class" />
            </div>

        </div>

    </fieldset>
}


<!-- Modal for progress-->
<div class="modal fade" id="progressModal" tabindex="-1"
     role="dialog" data-backdrop="static"
     aria-labelledby="progressModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close"
                        data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title" id="progressModalLabel">
                    processing...
                </h5>
            </div>
            <div class="modal-body">

                <div id="progress_container" class="progress">
                    <div id="progressbar"
                         class="progress-bar indeterminate progress-bar-warning progress-bar-striped progress-bar-animated active"
                         role="progressbar"
                         aria-valuenow="0"
                         aria-valuemin="0"
                         aria-valuemax="100"
                         style="width: 100%">
                        <span id="current-progress"></span>
                    </div>

                </div>


                <div id="div_progress_msg" class="text-center"></div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Modal ends here -->




@section Scripts {

    <script type="text/javascript">

        $(document).ready(function () {

            //document.getElementById('btnlogin').addEventListener('click', function (event) {
            //    event.preventDefault();
            //    //login();
            //});

            document.getElementById('chkshowpassword').addEventListener('click', function (event) {
                event.preventDefault();
                show_hide_password();
            });

            document.getElementById('lblshowpassword').addEventListener('click', function (event) {
                event.preventDefault();
                show_hide_password();
            });

            function show_hide_password() {
                const txtpassword = document.getElementById("txtpassword");
                const chkshowpassword = document.getElementById("chkshowpassword");

                if (chkshowpassword.checked) {
                    txtpassword.type = "text";
                }
                else {
                    txtpassword.type = "password";
                }

            }

            //login
            function login() {

                showprogressmodal();
                showprogressbar();

                // get form fields values
                var email = $("#txtemail").val();
                var password = $("#txtpassword").val();

                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("Login", "Users")',
                    data: {
                        "email": email,
                        "password": password
                    } //data to be posted
                }).done(function (data) {

                    // hide modal popup
                    hideprogressmodal();

                    hideprogressbar();

                    // redirect to admin page
                    //window.location = @*@Url.Action("Index", "Missions")';*@

                }).fail(function (jqXHR, textStatus) {

                    hideprogressbar();
                });

                //hideprogressbar();

            }

            function hideprogressbar() {
                // $(".progress").css("display", "none");
                // $(".progress-bar").css("display", "none");
                $('.progress').fadeOut(2000); // hide the element using timer
                $('.progress-bar').fadeOut(2000); // hide the element using timer
                hide_toast();
            }

            function showprogressbar() {
                // $(".progress").css("display", "block");
                // $(".progress-bar").css("display", "block");
                $('.progress').fadeIn(100); // display the element using timer
                $('.progress-bar').fadeIn(100); // display the element using timer
                show_toast();
            }

            function showprogressmodal() {
                // Open modal popup
                $("#progressModal").modal("show");
            }

            function hideprogressmodal() {
                // hide modal popup
                $("#progressModal").modal("hide");
            }

        });

    </script>
}








